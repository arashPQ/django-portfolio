{% extends 'base.html' %}

{% load static %}


{% block title %}
    {{ project.title }}
{% endblock title %}

{% block content %}
  <section id="portfolio-details" class="portfolio-details section">

    <div class="container" data-aos="fade-up" data-aos-delay="100">
      <div class="row gy-4">
        <div class="col-lg-8">
          <div class="portfolio-details-slider swiper init-swiper">

            <div class="swiper-wrapper align-items-center">

                <div class="swiper-slide gallery">
                    {% if imgs %}
                        <img src="{{ imgs.0.image.url }}" class="thumb" alt="Image 1">
                    {% endif %}
                </div>
            </div>


            <div id="modal" class="modal">
                <span id="close">&times;</span>
                <img class="modal-content" id="modal-img">
                <div id="modal-controls"></div>
            </div>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="portfolio-info" data-aos="fade-up" data-aos-delay="200">
            <h3>Project information</h3>
            <ul>
              <li><strong>Category</strong>: {{ project.type }}</li>
              <li><strong>Developer</strong>: {{ project.developer }}</li>
              <li><strong>last update</strong>: {{ project.modified_at | date:"M d Y" }}</li>
              <li><strong>Project URL</strong>: <a href="{{ project.link }}">Github Link <i class="bi bi-box-arrow-up-right"></i></a></li>
            </ul>
          </div>
          <div class="portfolio-description" data-aos="fade-up" data-aos-delay="300">
            <h2>Description of project</h2>
            <p>
              {{ project.description }}
            </p>
          </div>
        </div>
      </div>
    </div>

  </section>
{% endblock content %}



{% block scripts %}
  <script>
    const modal = document.getElementById('modal');
    const modalImg = document.getElementById('modal-img');
    const closeBtn = document.getElementById('close');
    const controls = document.getElementById('modal-controls');

    const thumbs = document.querySelectorAll('.thumb');
    let images = [];

    {% for img in imgs %}
      images.push("{{ img.image.url }}");
    {% endfor %}

    let currentIndex = 0;

    function showImage(index){
      currentIndex = index;
      modalImg.src = images[index];
      modal.style.display = 'flex';
    }

    images.forEach((img, i) => {
      const btn = document.createElement('button');
      btn.textContent = i + 1;
      btn.addEventListener('click', () => showImage(i));
      controls.appendChild(btn);
    });

    if(thumbs[0]){
      thumbs[0].addEventListener('click', () => showImage(0));
    }

    closeBtn.addEventListener('click', () => modal.style.display = 'none');
    modal.addEventListener('click', e => { if(e.target === modal) modal.style.display='none'; });
  </script>
{% endblock scripts %}
  